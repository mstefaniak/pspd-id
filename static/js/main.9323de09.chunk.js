(this["webpackJsonppspd-id"]=this["webpackJsonppspd-id"]||[]).push([[0],{12:function(e,t,n){},14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(6),c=n.n(s),o=(n(12),n(7)),i=n(2),l=n.n(i),u=n(4),d=n(3),m=(n(14),n.p+"static/media/logo.860f766d.png"),p="pl-PL",b="https://crm-test.pspd.org.pl/api",j=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(b,"/user/token"),{method:"POST",body:JSON.stringify({username:t,password:n}),headers:{"Content-Type":"application/json"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.abrupt("return",null===a||void 0===a?void 0:a.token);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t,n);case 2:return r=e.sent,e.next=5,fetch("".concat(b,"/user/login"),{method:"POST",body:JSON.stringify({username:t,password:n}),credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r}});case 5:return a=e.sent,e.next=8,a.json();case 8:return s=e.sent,sessionStorage.setItem("token",null===s||void 0===s?void 0:s.token),e.abrupt("return",a.status<400);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(t,n);case 2:if(e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",h());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=sessionStorage.getItem("token")){e.next=4;break}return console.error("Token not found"),e.abrupt("return",null);case 4:return e.next=6,fetch("".concat(b,"/data/userdata"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":t}});case 6:if(!((n=e.sent).status>=400)){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,n.json();case 11:if(!(r=e.sent)||!r.length){e.next=15;break}return sessionStorage.setItem("lastUpdate",Date.now().toString()),e.abrupt("return",r[0]);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=n(0),v=function(){return Object(g.jsx)("div",{className:"sm:min-h-screen sm:flex sm:items-start sm:justify-center sm:bg-gray-50 sm:py-12",children:Object(g.jsxs)("svg",{className:"animate-spin h-10 w-10 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[Object(g.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"#000",strokeWidth:"4"}),Object(g.jsx)("path",{className:"opacity-75",fill:"#000",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},O=function(e){var t=e.onSuccess,n=Object(r.useState)(!1),a=Object(d.a)(n,2),s=a[0],c=a[1],o=Object(r.useState)(),i=Object(d.a)(o,2),p=i[0],b=i[1],j=Object(r.useState)(),f=Object(d.a)(j,2),h=f[0],O=f[1],w=Object(r.useState)(!1),y=Object(d.a)(w,2),N=y[0],k=y[1],S=function(){var e=Object(u.a)(l.a.mark((function e(n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!h||!p){e.next=8;break}return c(!0),e.next=5,x(p,h);case 5:(r=e.sent)?t(r):k(!0),c(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s?Object(g.jsx)(v,{}):Object(g.jsx)("div",{className:"min-h-screen flex items-start justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:Object(g.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("img",{src:m,alt:"logo",className:"-mb-20 -mt-10"}),Object(g.jsx)("h2",{className:"text-center text-2xl font-extrabold text-gray-900",children:"LEGITYMACJA"})]}),N&&Object(g.jsx)("div",{className:"bg-red-200 text-red-600 p-4 text-center rounded",children:"Niepoprawny email i/lub has\u0142o"}),Object(g.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:S,children:[Object(g.jsx)("input",{type:"hidden",name:"remember",value:"true"}),Object(g.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email"}),Object(g.jsx)("input",{value:p,onChange:function(e){b(e.target.value)},id:"email-address",name:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email"})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Has\u0142o"}),Object(g.jsx)("input",{value:h,onChange:function(e){O(e.target.value)},id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Has\u0142o"})]})]}),Object(g.jsx)("div",{children:Object(g.jsx)("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",children:"Zaloguj"})})]})]})})},w=function(){return Object(g.jsx)("div",{className:"sm:min-h-screen sm:flex sm:items-start sm:justify-center sm:bg-gray-50 sm:py-12",children:Object(g.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:"Legitymacja nieaktywna"})})},y=function(e){var t=e.label,n=e.value,r=e.isEven,a="".concat(void 0!==r&&r?"bg-gray-50":"bg-white"," px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6");return Object(g.jsxs)("div",{className:a,children:[Object(g.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:t}),Object(g.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:n})]})},N=function(e){var t=e.firstName,n=e.lastName,a=e.id,s=e.status,c=e.joinDate,o=e.ot,i=Object(r.useState)(Date.now()),l=Object(d.a)(i,2),u=l[0],b=l[1],j="Current"===s,f="".concat(t," ").concat(n),x=Number(sessionStorage.getItem("lastUpdate")),h=u-x>288e5;Object(r.useEffect)((function(){var e=setInterval((function(){b(Date.now())}),3e4);return function(){clearInterval(e)}}),[]);var v=new Intl.DateTimeFormat(p,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(x);return j?Object(g.jsx)("div",{className:"sm:min-h-screen sm:flex sm:items-start sm:justify-center sm:bg-gray-50 sm:py-12",children:Object(g.jsxs)("div",{className:"sm:max-w-lg sm:shadow bg-white overflow-hidden sm:rounded-lg",children:[Object(g.jsxs)("div",{className:"px-4 py-1 sm:px-6 grid grid-cols-2",children:[Object(g.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 flex items-center",children:"Legitymacja"}),Object(g.jsx)("div",{className:"flex justify-end",children:Object(g.jsx)("img",{src:m,className:"App-logo",alt:"logo"})})]}),Object(g.jsx)("div",{className:"border-t border-gray-200",children:Object(g.jsxs)("dl",{children:[Object(g.jsx)(y,{label:"Imi\u0119 i nazwisko",value:Object(g.jsx)("span",{className:"font-bold",children:f}),isEven:!0}),Object(g.jsx)(y,{label:"Numer",value:a}),Object(g.jsx)(y,{label:"Sk\u0142adka op\u0142acona",value:Object(g.jsx)("span",{className:"text-green-600 font-bold",children:"TAK"}),isEven:!0}),Object(g.jsx)(y,{label:"Data przyst\u0105pienia",value:new Intl.DateTimeFormat(p).format(1e3*Number(c))}),Object(g.jsx)(y,{label:"Oddzia\u0142",value:o,isEven:!0}),Object(g.jsx)(y,{label:"Ostatnia aktualizacja",value:Object(g.jsx)("span",{className:h?"text-red-600 font-bold":"",children:v})})]})})]})}):Object(g.jsx)(w,{})},k=function(){var e=Object(r.useState)(!0),t=Object(d.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(),c=Object(d.a)(s,2),i=c[0],m=c[1],p=Object(r.useCallback)(Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:(t=e.sent)&&m(t);case 4:case"end":return e.stop()}}),e)}))),[h]);Object(r.useEffect)((function(){p().then((function(){return a(!1)}))}),[p]);return n?Object(g.jsx)(v,{}):i?Object(g.jsx)(N,Object(o.a)({},i)):Object(g.jsx)(O,{onSuccess:function(e){m(e)}})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))},C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function T(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(k,{})}),document.getElementById("root")),S(),function(){if("serviceWorker"in navigator){if(new URL("/pspd-id",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/pspd-id","/service-worker.js");C?(!function(e){fetch(e).then((function(t){var n,r;404===t.status||-1===(null===t||void 0===t||null===(n=t.headers)||void 0===n||null===(r=n.get("content-type"))||void 0===r?void 0:r.indexOf("javascript"))?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):T(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):T(e)}))}}()}},[[16,1,2]]]);
//# sourceMappingURL=main.9323de09.chunk.js.map